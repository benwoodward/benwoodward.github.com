<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A quick way to setup colourized and pretty printed JSON cURL output. Useful when you need to manually test your JSON API.">
		<title>Colourized, Pretty Printed JSON with cURL and Bash</title>
    <meta name="author" content="Ben Woodward">
    <meta name="viewport" content="width=device-width; initial-scale=1.0;">
    <meta name="msapplication-tooltip" content="Ben Woodward's blog on Ruby, Rails and other things.">
		<link rel="stylesheet" href="/stylesheets/style.css" type="text/css">
    <link rel="alternate" href="/atom.xml" type="application/atom+xml" title="Ruby on Rails Developer">
	</head>
  <body>
    <header class="banner navbar navbar-static-top">
      <div class="navbar-inner">
        <a class="brand" href="http://benw.me"></a>
        <h3>Ben Woodward</h3>
          <p class="social">
            <a href="http://twitter.com/benwdwd" class="ss-icon ss-social-circle ss-twitter"></a>
            <a href="https://github.com/benwoodward" class="ss-icon ss-social-circle ss-octocat"></a>
            <a href="/atom.xml" class="ss-icon ss-social-circle ss-rss"></a>
          </p>
          <p>
            <script type="text/javascript">
              //<![CDATA[
              <!--
              var x="function f(x){var i,o=\"\",ol=x.length,l=ol;while(x.charCodeAt(l/13)!" +
              "=55){try{x+=x;l+=l;}catch(e){}}for(i=l-1;i>=0;i--){o+=x.charAt(i);}return o" +
              ".substr(0,ol);}f(\")701,\\\"t~veit(g{#(j4,$\\\"\\\\771\\\\\\\\\\\\300\\\\63" +
              "0\\\\g_t030\\\\CUT@]]r220\\\\s320\\\\H@_C]010\\\\500\\\\zJHOGi530\\\\k}xvyo" +
              "j'r{;c}wsPm4bxgche%Z8bfpi 730\\\\A^S420\\\\520\\\\530\\\\300\\\\730\\\\700\\"+
              "\\300\\\\]600\\\\730\\\\520\\\\200\\\\330\\\\610\\\\300\\\\710\\\\\\\"(f};o" +
              " nruter};))++y(^)i(tAedoCrahc.x(edoCrahCmorf.gnirtS=+o;721=%y;i=+y)701==i(f" +
              "i{)++i;l<i;0=i(rof;htgnel.x=l,\\\"\\\"=o,i rav{)y,x(f noitcnuf\")"           ;
              while(x=eval(x));
              //-->
              //]]>
            </script>
          </p>
      </div>
    </header>
    <div id="wrap">
      <article data-id="postscolourized-pretty-printed-json-with-curl">
  <header>
  <h2>Colourized, Pretty Printed JSON with cURL and Bash</h2>
  <time>13 Oct 2014</time>
  </header>
  <div class="entry-content">
    <h3 id="overview">Overview</h3>

<p>Working with APIs I do a lot of manual testing on the command line using cURL. Typing out </p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">curl -H "Accept: application/json" -H "Content-Type: application/json" -H "X-User-Email: name@example.com" -H "X-User-Token: a4pQnAiprk6-qczS3rn6"</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>over and over quickly becomes tiresome. Here I will explain a simple bash function I use that will simplify the command plus pretty print, and colourise the JSON output in your Terminal. This tutorial is written for intermediate developers using Macs, however, I’m sure all these commands will work fine on Linux machines. Let me know in the comments if you have a problem.</p>

<h3 id="npm-jsontool">npm jsontool</h3>

<p>First install jsontool from npm</p>

<p>https://www.npmjs.org/package/jsontool</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">npm install jsontool</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Now you should be able to pipe cURL output to it, like so;</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>curl http://localhost:3000/api/v1/exercises <span class="p">|</span> json
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><img src="/images/pretty_print_json/00_no_highlighting.png" alt="cURL output" title="cURL output" /></p>

<h3 id="colourisation">Colourisation</h3>

<p>You may have Python installed already, otherwise, run the following command..</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">brew install python</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Followed by..</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">pip install pygments</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Alternatively, you can install Pygments using Python’s built in <code>easy_install</code></p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">sudo easy_install pygments</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>You may need to reload your shell, so that $PATH is reloaded, I normally just create a new Terminal tab to do this.</p>

<p>Now we can pipe our JSON through the <code>pygmentize</code> tool that comes with pygments. It’s normally installed to <code>/usr/local/bin</code>:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class=""><span class="line">$ which pygmentize
</span><span class="line">/usr/local/bin/pygmentize</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Don’t forget to specify json as the lexer for pygmentize with <code>-l json</code>…</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>curl http://localhost:3000/api/v1/exercises <span class="p">|</span> json <span class="p">|</span> pygmentize -l json
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><img src="/images/pretty_print_json/01_highlighted.png" alt="cURL output" title="cURL output" /></p>

<h4 id="a-bash-function">A Bash Function</h4>

<p>Now we can wrap this up in a simple bash function (add this to your ~/.bash_profile)</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>.bash_profile  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="k">function</span> jcurl<span class="o">()</span> <span class="o">{</span>
</span><span class="line">    curl <span class="s2">&quot;$1&quot;</span> <span class="p">|</span> json <span class="p">|</span> pygmentize -l json
</span><span class="line"><span class="o">}</span>
</span><span class="line"><span class="nb">export</span> -f jcurl
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Reload your .bash_profile using..</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">source ~/.bash_profile</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Now we can get the same result as before, just using the command like so..</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>jcurl http://localhost:3000/api/v1/exercises
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Let’s modify the jcurl function a bit. If we replace the <code>$1</code> shell variable, which takes the first argument from the command line as input, and replace it with <code>$@</code>, then it will act like </p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>.bash_profile  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="k">function</span> jcurl<span class="o">()</span> <span class="o">{</span>
</span><span class="line">    curl <span class="s2">&quot;$@&quot;</span> <span class="p">|</span> json <span class="p">|</span> pygmentize -l json
</span><span class="line"><span class="o">}</span>
</span><span class="line"><span class="nb">export</span> -f jcurl
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This allows us to pass more than one option to <code>jcurl</code> ..For example, if we wanted to pass headers..</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">jcurl -H "X-User-Token: a4pQnAiprk6-qczS3rn6" -H "X-User-Email: name@example.com" http://localhost:3000/api/v1/exercises</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>For added convenience, I decided to do this;</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>.bash_profile  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="k">function</span> auth-jcurl<span class="o">()</span> <span class="o">{</span>
</span><span class="line">    curl -H <span class="s2">&quot;Accept: application/json&quot;</span> -H <span class="s2">&quot;Content-Type: application/json&quot;</span> -H <span class="s2">&quot;X-User-Email: $1&quot;</span> -H <span class="s2">&quot;X-User-Token: $2&quot;</span> <span class="k">${</span><span class="p">@:</span><span class="nv">3</span><span class="k">}</span> <span class="p">|</span> json <span class="p">|</span> pygmentize -l json
</span><span class="line"><span class="o">}</span>
</span><span class="line"><span class="nb">export</span> -f auth-jcurl
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><code>${@:3}</code> is the array of command line arguments minus the first 2, (because we’ve already used them with <code>$1</code> and <code>$2</code>).</p>

<p>We can now pass the username and access token to cURL and any additional options (which will be picked up by “$@”)</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">$ auth-jcurl name@example.com a4pQnAiprk6-qczS3rn6 http://localhost:3000/api/v1/exercises</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Let me know in the comments below if you found this helpful, or can suggest any improvements.</p>

  </div>
  
    <div id="comments-container">
      <h1>Comments</h1>
      <div id="disqus_thread" aria-live="polite">
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
      <script type="text/javascript">
        var disqus_shortname = 'benwme';
        // var disqus_developer = 1;
        var disqus_identifier = 'http://benw.me/posts/colourized-pretty-printed-json-with-curl/';
        var disqus_url = 'http://benw.me/posts/colourized-pretty-printed-json-with-curl/';
        (function () {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
      </script>
    </div>
  
</article>

    </div>
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '540cffcfeddd5b6480004105');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>
